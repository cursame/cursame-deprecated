<style>
#filters{ padding:0; margin:0 0 20px -10px;}
#filters li{ list-style:none; display:inline; padding:0 10px 0 0; color:#999; }
#filters li a{ padding:0 0 0 10px; text-decoration:none; }
#filters li a.selected{ color:#000; text-decoration:none;}
#reportes-container{ margin-left:-6px; width:106%; float:left; }
#reportes-container .element {
  margin:6px;
  float: left;
  overflow: hidden;
  position: relative;
  width:180px;
  height:160px;
  border: solid 1px #ddd;
}

.element p{
  font-size: 12px;
  font-weight: bold;
  text-align: center;
}

.element a{
  padding-left: 60px;
}
/* Start: Recommended Isotope styles */

/**** Isotope Filtering ****/

.isotope-item {
  z-index: 2;
}

.isotope-hidden.isotope-item {
  pointer-events: none;
  z-index: 1;
}

/**** Isotope CSS3 transitions ****/

.isotope,
.isotope .isotope-item {
  -webkit-transition-duration: 0.8s;
  -moz-transition-duration: 0.8s;
  -o-transition-duration: 0.8s;
  transition-duration: 0.8s;
}

.isotope {
  -webkit-transition-property: height, width;
  -moz-transition-property: height, width;
  -o-transition-property: height, width;
  transition-property: height, width;
}

.isotope .isotope-item {
  -webkit-transition-property: -webkit-transform, opacity;
  -moz-transition-property:    -moz-transform, opacity;
  -o-transition-property:         top, left, opacity;
  transition-property:         transform, opacity;
}

/**** disabling Isotope CSS3 transitions ****/

.isotope.no-transition,
.isotope.no-transition .isotope-item,
.isotope .isotope-item.no-transition {
  -webkit-transition-duration: 0s;
  -moz-transition-duration: 0s;
  -o-transition-duration: 0s;
  transition-duration: 0s;
}

/* End: Recommended Isotope styles */



/* disable CSS transitions for containers with infinite scrolling*/
.isotope.infinite-scrolling {
  -webkit-transition: none;
  -moz-transition: none;
  -o-transition: none;
  transition: none;
}
</style>
<div class="container">
  <div class="row">
    <div class="span16">
      <ul class="breadcrumb">
        <li><%= link_to(t('.admin'), supervisor_dashboard_path) %></li>
      </ul>  
    </div>
  </div>
  <div class="dashboard">  
    <div class="row">
      <div class="span5">
        <%= render :partial => "supervisor/shared/admin_menu" %>
      </div>    
      <div class="span-two-thirds">
        <div class="dashboard-box">
          <div class="underline padding-top">
            <h2>Analytics</h2>
          </div>
          <div class="form-inline">
            Elige Mes : <input type="text" id="mes-selector" value ="01-2013">              
              <input type="radio" name="radio" value=".semanal" class="checks"> Semanal /
              <input type="radio" name="radio" value=".quincenal" class="checks"> Quincenal /
              <input type="radio" name="radio" value=".mensual" class="checks"> Mensual

          </div>
          </br>
          <section id="options" class="clearfix">
            <ul id="filters" class="option-set clearfix" data-option-key="filter">
              <li><a href="#filter" data-option-value=".usuarios">Usuarios</a></li>
              <li>/<a href="#filter" data-option-value=".posts">Posts</a></li>
              <li>/<a href="#filter" data-option-value=".logins">Logins</a></li>
              <li>/<a href="#filter" data-option-value=".dispositivos">Dispositivos</a></li>
              <li>/<a href="#filter" data-option-value=".post_comentarios">Post/Comentarios</a></li>
              <li>/<a href="#filter" data-option-value=".quizzes">Quizzes</a></li>
            </ul>
          </section>

          <div id="reportes-container" class="clearfix">

            <!-- USUARIOS SEMANAL -->

            <% Date.strptime("2012/12/13","%Y/%m/%d").each_week_since do |date| %>
              <div class="element usuarios semanal <%= (date + 7.days).month_to_string %>-<%= date.year %>" >
                <p>Usuarios</p>
                <a href="http://50.116.21.144/users-<%= date.strftime('%Y%m%d') %>-<%= (date + 7.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 7.days).day %> de 
                  <%= (date + 7.days).month_to_string.downcase %>
                </p>
              </div>
            <% end %>
            
            <!-- USUARIOS QUINCENALES -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>

              <div class="element usuarios quincenal <%= (date + 14.days).month_to_string %>-<%= date.year %>" >
                <p>Usuarios</p>
                <a href="http://50.116.21.144/users-<%= date.strftime('%Y%m%d') %>-<%= (date + 14.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 14.days).day %> de 
                  <%= date.month_to_string.downcase %>
                </p>
              </div>

              <div class="element usuarios quincenal <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Usuarios</p>
                <a href="http://50.116.21.144/users-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= (Date.civil(date.year, date.month, 15)).day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>

            <% end %>

            <!-- USUARIOS MENSUALES -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>
              <div class="element usuarios mensual <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Usuarios</p>
                <a href="http://50.116.21.144/users-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- POSTS SEMANALES -->

            <% Date.strptime("2012/12/13","%Y/%m/%d").each_week_since do |date| %>
              <div class="element posts semanal <%= (date + 7.days).month_to_string %>-<%= date.year %>" >
                <p>Posts</p>
                <a href="http://50.116.21.144/posts-<%= date.strftime('%Y%m%d') %>-<%= (date + 7.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 7.days).day %> de 
                  <%= (date + 7.days).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- POSTS QUINCENALES -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>

              <div class="element posts quincenal <%= (date + 14.days).month_to_string %>-<%= date.year %>" >
                <p>Posts</p>
                <a href="http://50.116.21.144/posts-<%= date.strftime('%Y%m%d') %>-<%= (date + 14.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 14.days).day %> de 
                  <%= date.month_to_string.downcase %>
                </p>
              </div>

              <div class="element posts quincenal <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Posts</p>
                <a href="http://50.116.21.144/posts-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= (Date.civil(date.year, date.month, 15)).day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>

            <% end %>

            <!-- POSTS MENSUALES -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>
              <div class="element posts mensual <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Posts</p>
                <a href="http://50.116.21.144/posts-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- LOGINS SEMANALES -->

            <% Date.strptime("2012/12/13","%Y/%m/%d").each_week_since do |date| %>
              <div class="element logins semanal <%= (date + 7.days).month_to_string %>-<%= date.year %>" >
                <p>Logins</p>
                <a href="http://50.116.21.144/logins-<%= date.strftime('%Y%m%d') %>-<%= (date + 7.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 7.days).day %> de 
                  <%= (date + 7.days).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- LOGINS QUINCENALES -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>
              <div class="element logins quincenal <%= (date + 15.days).month_to_string %>-<%= date.year %>" >
                <p>Logins</p>
                <a href="http://50.116.21.144/logins-<%= date.strftime('%Y%m%d') %>-<%= (date + 15.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 15.days).day %> de 
                  <%= date.month_to_string.downcase %>
                </p>
              </div>
              <div class="element logins quincenal <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Logins</p>
                <a href="http://50.116.21.144/logins-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= (Date.civil(date.year, date.month, 15)).day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- LOGINS MENSUALES -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>
              <div class="element logins mensual <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Logins</p>
                <a href="http://50.116.21.144/logins-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- DISPOSITIVOS SEMANAL -->

            <% Date.strptime("2012/12/13","%Y/%m/%d").each_week_since do |date| %>
              <div class="element dispositivos semanal <%= (date + 7.days).month_to_string %>-<%= date.year %>" >
                <p>Dispositivos</p>
                <a href="http://50.116.21.144/devices-<%= date.strftime('%Y%m%d') %>-<%= (date + 7.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 7.days).day %> de 
                  <%= (date + 7.days).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- DISPOSITIVOS QUINCENAL -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>

              <div class="element dispositivos quincenal <%= (date + 14.days).month_to_string %>-<%= date.year %>" >
                <p>Dispositivos</p>
                <a href="http://50.116.21.144/devices-<%= date.strftime('%Y%m%d') %>-<%= (date + 14.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 14.days).day %> de 
                  <%= date.month_to_string.downcase %>
                </p>
              </div>

              <div class="element dispositivos quincenal <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Dispositivos</p>
                <a href="http://50.116.21.144/devices-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= (Date.civil(date.year, date.month, 15)).day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>

            <% end %>

            <!-- DISPOSITIVOS MENSUAL -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>
              <div class="element dispositivos mensual <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Dispositivos</p>
                <a href="http://50.116.21.144/devices-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- POST/COMENTARIOS SEMANAL -->

            <% Date.strptime("2012/12/13","%Y/%m/%d").each_week_since do |date| %>
              <div class="element post_comentarios semanal <%= (date + 7.days).month_to_string %>-<%= date.year %>" >
                <p>Post/Comentarios</p>
                <a href="http://50.116.21.144/most_commented-<%= date.strftime('%Y%m%d') %>-<%= (date + 7.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 7.days).day %> de 
                  <%= (date + 7.days).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- POST/COMENTARIOS QUINCENAL -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>

              <div class="element post_comentarios quincenal <%= (date + 14.days).month_to_string %>-<%= date.year %>" >
                <p>Post/Comentarios</p>
                <a href="http://50.116.21.144/most_commented-<%= date.strftime('%Y%m%d') %>-<%= (date + 14.days).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (date + 14.days).day %> de 
                  <%= date.month_to_string.downcase %>
                </p>
              </div>

              <div class="element post_comentarios quincenal <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Post/Comentarios</p>
                <a href="http://50.116.21.144/most_commented-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= (Date.civil(date.year, date.month, 15)).day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>

            <% end %>

            <!-- POST/COMENTARIOS MENSUAL -->

            <% Date.strptime("2012/12/01","%Y/%m/%d").each_month_since do |date| %>
              <div class="element post_comentarios mensual <%= (Date.civil(date.year, date.month, -1)).month_to_string %>-<%= date.year %>" >
                <p>Post/Comentarios</p>
                <a href="http://50.116.21.144/most_commented-<%= date.strftime('%Y%m%d') %>-<%= (Date.civil(date.year, date.month, -1)).strftime('%Y%m%d') %>.csv">
                  <img src="/assets/report.png" alt="Image" width="64px"/>
                </a>
                <p>
                  <%= date.day %> de <%= date.month_to_string.downcase %> al <%= (Date.civil(date.year, date.month, -1)).day %> de 
                  <%= (Date.civil(date.year, date.month, -1)).month_to_string.downcase %>
                </p>
              </div>
            <% end %>

            <!-- QUIZZES -->

            <% Survey.all.each do |survey| %>
            <div class="element quizzes" > 
              <p> <%= survey.name%> </p>
              <%= link_to image_tag("/assets/report.png", :width=>"64px"), :controller=>"analytics", :action=>"surveys", :format=>"csv", :survey_id => survey.id %>
              <p><%= survey.created_at.to_s.split.first %></p>
            </div>
            <% end %>

          </div> <!-- #container -->
        </div>
      </div>
    </div>
  </div>
</div>
<%= render :partial => "shared/footer" %>
<script type="text/javascript" src="http://isotope.metafizzy.co/js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="http://isotope.metafizzy.co/jquery.isotope.min.js"></script>
<link rel='stylesheet' href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/base/jquery-ui.css'>
<script type="text/javascript" src="https://raw.github.com/lucianocosta/jquery.mtz.monthpicker/master/jquery.mtz.monthpicker.js"></script>


<script type="text/javascript">

var filters = ['.Enero-2013',''],
    year = '2013';

$(function () {

  $(".element a img").hover(function() {
    $(this).stop().animate({opacity: "0.8"}, 'slow');
  },
  function() {
    $(this).stop().animate({opacity: "1"}, 'slow');
  });

  var $container = $('#reportes-container'),
  meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
  'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];

  $container.isotope({
    itemSelector: '.element'
  });

  $container.isotope({ filter: filters.join('') });
  
  //link picker(usuarios/post/coments ...)
  var $optionSets = $('#options .option-set'),
      $optionLinks = $optionSets.find('a');

      $optionLinks.click(function(){
        var $this = $(this);
        // don't proceed if already selected
        if ( $this.hasClass('selected') ) {
          return false;
        }
        var $optionSet = $this.parents('.option-set');
        $optionSet.find('.selected').removeClass('selected');
        $this.addClass('selected');

        var value = $this.attr('data-option-value');

        filters[1]= value;

        if(value == '.quizzes'){
          $container.isotope({ filter: value });
          return false;
        }

        $container.isotope({ filter: filters.join('') });
        
        return false;
      });

  var $checkboxes = $('div.form-inline input');

   $checkboxes.change(function(){
    var filter;
    // get checked checkboxes values
    $checkboxes.filter(':checked').each(function(){
      filter = this.value;
    });
    
    filters[2] = filter;
    $container.isotope({ filter: filters.join('') });
  });

  //month picker
  $('#mes-selector').monthpicker({
    pattern: 'mm-yyyy',
    selectedYear: 2013,
    startYear: 2012,
    finalYear: 2050,
    monthNames: meses
  }).bind('monthpicker-click-month', function (e, month) {
    var date = new Date(e.timeStamp),
    filter = '.'+meses[ month - 1]+'-'+ year ;

    filters = [];
    $('#options-meses .option-set').find('.selected').removeClass('selected');
    $('#options .option-set').find('.selected').removeClass('selected');
    
    $('.checks').each(function(){
      this.checked = false;
    });


    filters[0] = filter;
    $container.isotope({ filter: filters.join('') });
  }).bind('monthpicker-change-year',function(e,y){
      year = y;
  });

});
</script>
