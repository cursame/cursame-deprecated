/**
 * @class Cursame.model.Notification
 * @extends Ext.data.Model
 * The Notification model is the model used for notifications. We're using a custom Proxy for
 * this application to enable us to consume Cursame's JSON api. See lib/CursameProxy.js to see how this is done
 */
Ext.define("Cursame.model.Notification",{extend:"Ext.data.Model",config:{fields:[{name:"id",type:"int"},{name:"text",type:"string",convert:function(a,b){var c,d;return a.text?(c=a.text[0].toUpperCase()+a.text.slice(1),d=b.data,d.user=a.user?a.user.last_name+""+a.user.first_name:"",d.survey=a.survey?a.survey.name:"",d.asignment=a.asignment?a.asignment.name:"",d.course=a.course?a.course.name:"",d.text2=a.text2?a.text2:"",d.state=a.notificator?a.notificator.state:"",d.course_id=a.course?a.course.id:"",d.courseObject=a.course?a.course:"",d.courseOwner=a.course?a.courseOwner:"",d.courseComments=a.course?a.courseComments:"",d.courseMembers=a.course?a.courseMembers:"",[c,'<em class="active-font">',d.survey,"</em>",d.text2,'<em class="active-font">',d.course,"</em>"].join(" ")):""}},{name:"user_id",type:"string"},{name:"notificator_type",type:"string"},{name:"notificator_id",type:"string"},{name:"avatar",type:"string",mapping:"text.image",convert:function(a,b){return console.log(a),a=a?Cursame.Path+a.url:Cursame.src+"resources/images/avatar_normal.png",console.log(a),a}},{name:"user",type:"string"},{name:"survey",type:"string"},{name:"asignment",type:"string"},{name:"course",type:"string"},{name:"text2",type:"string"},{name:"kind",type:"string"},{name:"state",type:"string"},{name:"course_id",type:"int"},{name:"courseObject"},{name:"courseOwner"},{name:"courseComments"},{name:"courseMembers"},{name:"btn",type:"boolean",convert:function(a,b){return b.get("kind")==="student_course_enrollment"&&b.get("state")==="pending"?!1:!0}},{name:"created",type:"date",mapping:"created_at",convert:function(a,b){try{var c=Math.ceil(Number(new Date)/1e3),d=Math.ceil(Number(new Date(a))/1e3),e=c-d,f;return e<60?String(e)+" s":e<3600?(f=String(Math.ceil(e/60)),f+(f=="1"?" m":" m")):e<86400?(f=String(Math.ceil(e/3600)),f+(f=="1"?" h":" h")):e<31536e3?(f=String(Math.ceil(e/86400)),f+(f=="1"?" d":" d")):Ext.Date.format(new Date(a),"jS M 'y")}catch(g){return""}}}],proxy:{type:"jsonp",url:Cursame.Url+"api/notifications.json",reader:{type:"json",rootProperty:"notifications"}}}});